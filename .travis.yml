language: ruby
env:
  - DB=mysql
rvm:
  - 2.2.3
  - rbx-2.5.8
bundler_args: --without production  --binstubs --full-index
before_script:
  - mysql -e 'create database myl_test'
before_install:
  - gem update --system
  - gem --version
  # - 'command -v brew && brew update || echo "no brew"'
  - 'command -v brew && brew install mysql || echo "no brew"'
  # - 'command -v apt-get && sudo apt-get update -qq || echo "no apt-get"'
after_install:
  - bundle-audit update
  - bundle-audit
services:
  - redis-server
  - mysql
script:
  - RAILS_ENV=test bundle exec rake db:migrate --trace
  - bundle exec rake db:test:prepare
  - bundle exec rspec spec/
cache:
  bundler: true
  apt: true
  directories:
  - vendor/assets
  - vendor/bundle
  - vendor/cache
os:
  - linux
  - osx
sudo: false